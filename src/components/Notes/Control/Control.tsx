import React, { Dispatch, SetStateAction } from "react";

import "./Control.css";
import { useNavigate } from "react-router-dom";
import { useFetchAddNoteCartMutation } from "../../../redux/api";
type ControlTypes = {
  name: string;
  _id: string;
  username: string;
  controlCords: { x: number; y: number };
  setOpenNoteControl: Dispatch<SetStateAction<boolean>>;
};

export const Control: React.FC<ControlTypes> = ({
  name,
  _id,
  username,
  controlCords,
  setOpenNoteControl,
}) => {
  const navigate = useNavigate();

  const [addCart] = useFetchAddNoteCartMutation();

  //  ПОМЕЩАЕМ ЗАМЕТКУ В КОРЗИНУ
  const handleDeleteNote = (id: string) => {
    addCart(id);
    setOpenNoteControl(false);
    navigate("/documents");
  };

  return (
    <div
      className="absolute left-[195px] w-[225px] bg-white-50 box-shadow z-50"
      onClick={(e) => e.stopPropagation()}
      style={{ top: controlCords.y }}
    >
      <div className="">
        <div className="bg-white"></div>
        <div className="p-2 px-0">
          <div
            className="flex items-center ml-1 mr-1 pt-1 pb-1 px-3 cursor-pointer rounded hover:bg-secondary-100 duration-200 ease-linear"
            onClick={() => handleDeleteNote(_id)}
          >
            <svg
              width="12"
              height="16"
              viewBox="0 0 12 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.125 5.62063L10.875 13.1875C10.8537 13.8356 10.5807 14.4498 10.114 14.8999C9.6472 15.35 9.02342 15.6004 8.37502 15.5981H3.62502C2.97703 15.6005 2.35361 15.3503 1.88692 14.9008C1.42023 14.4512 1.14695 13.8376 1.12502 13.19L0.875017 5.62063C0.869547 5.45487 0.930149 5.29373 1.04349 5.17265C1.15683 5.05157 1.31363 4.98047 1.47939 4.975C1.64515 4.96953 1.8063 5.03014 1.92737 5.14348C2.04845 5.25682 2.11955 5.41362 2.12502 5.57938L2.37502 13.1481C2.38747 13.4712 2.52464 13.777 2.75772 14.0011C2.99081 14.2252 3.30167 14.3502 3.62502 14.35H8.37502C8.69878 14.3502 9.01 14.2248 9.24315 14.0002C9.47631 13.7755 9.6132 13.4692 9.62502 13.1456L9.87502 5.57938C9.88049 5.41362 9.95158 5.25682 10.0727 5.14348C10.1937 5.03014 10.3549 4.96953 10.5206 4.975C10.6864 4.98047 10.8432 5.05157 10.9565 5.17265C11.0699 5.29373 11.1305 5.45487 11.125 5.62063ZM11.9519 3.1025C11.9519 3.26826 11.886 3.42724 11.7688 3.54445C11.6516 3.66166 11.4927 3.7275 11.3269 3.7275H0.673767C0.508007 3.7275 0.349035 3.66166 0.231825 3.54445C0.114615 3.42724 0.0487671 3.26826 0.0487671 3.1025C0.0487671 2.93674 0.114615 2.77777 0.231825 2.66056C0.349035 2.54335 0.508007 2.4775 0.673767 2.4775H2.61127C2.8093 2.47804 3.00044 2.40487 3.1475 2.27225C3.29457 2.13963 3.38703 1.95704 3.40689 1.76C3.45301 1.29781 3.66956 0.869336 4.01433 0.558072C4.3591 0.246807 4.8074 0.0750461 5.27189 0.0762545H6.72814C7.19263 0.0750461 7.64094 0.246807 7.98571 0.558072C8.33048 0.869336 8.54702 1.29781 8.59314 1.76C8.61301 1.95704 8.70547 2.13963 8.85253 2.27225C8.99959 2.40487 9.19074 2.47804 9.38877 2.4775H11.3263C11.492 2.4775 11.651 2.54335 11.7682 2.66056C11.8854 2.77777 11.9513 2.93674 11.9513 3.1025H11.9519ZM4.49189 2.4775H7.50939C7.42726 2.28984 7.37355 2.09099 7.35002 1.8875C7.33453 1.73345 7.26242 1.59062 7.14764 1.4867C7.03286 1.38278 6.8836 1.32516 6.72877 1.325H5.27252C5.11768 1.32516 4.96842 1.38278 4.85364 1.4867C4.73887 1.59062 4.66675 1.73345 4.65127 1.8875C4.62754 2.09103 4.57424 2.28988 4.49189 2.4775ZM5.12127 11.9469V6.625C5.12127 6.45924 5.05542 6.30027 4.93821 6.18306C4.821 6.06585 4.66203 6 4.49627 6C4.33051 6 4.17154 6.06585 4.05433 6.18306C3.93711 6.30027 3.87127 6.45924 3.87127 6.625V11.9494C3.87127 12.1151 3.93711 12.2741 4.05433 12.3913C4.17154 12.5085 4.33051 12.5744 4.49627 12.5744C4.66203 12.5744 4.821 12.5085 4.93821 12.3913C5.05542 12.2741 5.12127 12.1151 5.12127 11.9494V11.9469ZM8.13002 11.9469V6.625C8.13002 6.45924 8.06417 6.30027 7.94696 6.18306C7.82975 6.06585 7.67078 6 7.50502 6C7.33926 6 7.18029 6.06585 7.06308 6.18306C6.94586 6.30027 6.88002 6.45924 6.88002 6.625V11.9494C6.88002 12.1151 6.94586 12.2741 7.06308 12.3913C7.18029 12.5085 7.33926 12.5744 7.50502 12.5744C7.67078 12.5744 7.82975 12.5085 7.94696 12.3913C8.06417 12.2741 8.13002 12.1151 8.13002 11.9494V11.9469Z"
                fill="#E11D48"
              />
            </svg>
            <p className="ml-2 text-secondary-600 text-sm font-normal">
              Удалить
            </p>
          </div>
          <div className="flex items-center ml-1 mr-1 pt-1 pb-1 px-3 cursor-pointer rounded hover:bg-secondary-100 duration-200 ease-linear">
            <svg
              width="14"
              height="14"
              viewBox="0 0 14 14"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g clip-path="url(#clip0_121_175)">
                <path
                  d="M2.04167 14H10.7917C11.334 13.9985 11.8535 13.7818 12.2363 13.3976C12.6191 13.0134 12.8338 12.4931 12.8333 11.9508V7.55417C12.8333 7.39946 12.7719 7.25109 12.6625 7.14169C12.5531 7.0323 12.4047 6.97084 12.25 6.97084C12.0953 6.97084 11.9469 7.0323 11.8375 7.14169C11.7281 7.25109 11.6667 7.39946 11.6667 7.55417V11.9508C11.6674 12.1838 11.5757 12.4075 11.4117 12.573C11.2477 12.7385 11.0247 12.8321 10.7917 12.8333H2.04167C1.80867 12.8321 1.58568 12.7385 1.42163 12.573C1.25759 12.4075 1.16589 12.1838 1.16667 11.9508V3.21592C1.16589 2.98292 1.25759 2.75913 1.42163 2.59366C1.58568 2.4282 1.80867 2.33457 2.04167 2.33334H6.41667C6.57138 2.33334 6.71975 2.27188 6.82915 2.16248C6.93854 2.05309 7 1.90471 7 1.75001C7 1.5953 6.93854 1.44692 6.82915 1.33753C6.71975 1.22813 6.57138 1.16667 6.41667 1.16667H2.04167C1.49934 1.16822 0.979788 1.38486 0.597018 1.76905C0.214248 2.15324 -0.00046497 2.6736 7.56063e-07 3.21592V11.9508C-0.00046497 12.4931 0.214248 13.0134 0.597018 13.3976C0.979788 13.7818 1.49934 13.9985 2.04167 14Z"
                  fill="#1E293B"
                />
                <path
                  d="M5.51543 6.15067L5.05518 8.25884C5.03435 8.35446 5.03791 8.45379 5.06553 8.54767C5.09316 8.64156 5.14396 8.72699 5.21326 8.79609C5.28352 8.86345 5.36898 8.91289 5.4624 8.9402C5.55582 8.96752 5.65445 8.97191 5.74993 8.953L7.85343 8.49159C7.96265 8.4676 8.06268 8.41273 8.1416 8.3335L13.4581 3.017C13.6206 2.8545 13.7496 2.66157 13.8375 2.44923C13.9255 2.23689 13.9708 2.0093 13.9708 1.77946C13.9708 1.54962 13.9255 1.32204 13.8375 1.1097C13.7496 0.89736 13.6206 0.704428 13.4581 0.541922C13.1249 0.223501 12.6817 0.0458069 12.2208 0.0458069C11.76 0.0458069 11.3168 0.223501 10.9836 0.541922L5.67526 5.86367C5.59559 5.94205 5.54011 6.04167 5.51543 6.15067ZM11.8084 1.36734C11.9194 1.26102 12.0672 1.20167 12.2208 1.20167C12.3745 1.20167 12.5223 1.26102 12.6333 1.36734C12.7412 1.47737 12.8016 1.62534 12.8016 1.77946C12.8016 1.93358 12.7412 2.08155 12.6333 2.19159L12.2208 2.604L11.396 1.77917L11.8084 1.36734ZM6.61676 6.56717L10.5683 2.60575L11.3849 3.4265L7.43168 7.38909L6.38459 7.61892L6.61676 6.56717Z"
                  fill="#1E293B"
                />
              </g>
              <defs>
                <clipPath id="clip0_121_175">
                  <rect width="14" height="14" fill="white" />
                </clipPath>
              </defs>
            </svg>
            <p className="ml-2 text-secondary-600 text-sm font-normal">
              Переименовать
            </p>
          </div>
          <div className="w-full h-px bg-white-2 mt-1 mb-1"></div>
          <div className="px-4 text-sm font-normal text-secondary-400">
            <div>Заметка: {name}</div>
          </div>
          <div className="px-4 py-1 text-xs font-normal text-secondary-400 opacity-80">
            Создана: <span>16.03.24 14:07</span>
          </div>
        </div>
      </div>
    </div>
  );
};
