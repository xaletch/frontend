import React from "react";

import { useNavigate } from "react-router-dom";
import { useFetchAddNoteCartMutation } from "../../../redux/api";
import { ControlTypes } from "../../../app/types";

export const Control: React.FC<ControlTypes> = ({
  name,
  _id,
  createNote,
  controlCords,
  setOpenNoteControl,
}) => {
  const navigate = useNavigate();

  const [addCart] = useFetchAddNoteCartMutation();

  //  ПОМЕЩАЕМ ЗАМЕТКУ В КОРЗИНУ
  const handleDeleteNote = (id: string) => {
    addCart(id);
    setOpenNoteControl(false);
    navigate("/documents");
  };

  return (
    <div
      className="w-full h-full fixed left-0 top-0 z-50"
      onClick={() => setOpenNoteControl(false)}
    >
      <div
        className="absolute left-[195px] w-[225px] bg-white-50 shadow-sm rounded-lg z-50"
        onClick={(e) => e.stopPropagation()}
        style={{ top: controlCords.y }}
      >
        <div className="">
          <div className="bg-white"></div>
          <div className="p-2 px-0">
            <div
              className="flex items-center ml-1 mr-1 pt-1 pb-1 px-3 cursor-pointer rounded hover:bg-secondary-100 duration-200 ease-linear"
              onClick={() => handleDeleteNote(_id)}
            >
              <svg
                width="12"
                height="16"
                viewBox="0 0 12 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11.125 5.62063L10.875 13.1875C10.8537 13.8356 10.5807 14.4498 10.114 14.8999C9.6472 15.35 9.02342 15.6004 8.37502 15.5981H3.62502C2.97703 15.6005 2.35361 15.3503 1.88692 14.9008C1.42023 14.4512 1.14695 13.8376 1.12502 13.19L0.875017 5.62063C0.869547 5.45487 0.930149 5.29373 1.04349 5.17265C1.15683 5.05157 1.31363 4.98047 1.47939 4.975C1.64515 4.96953 1.8063 5.03014 1.92737 5.14348C2.04845 5.25682 2.11955 5.41362 2.12502 5.57938L2.37502 13.1481C2.38747 13.4712 2.52464 13.777 2.75772 14.0011C2.99081 14.2252 3.30167 14.3502 3.62502 14.35H8.37502C8.69878 14.3502 9.01 14.2248 9.24315 14.0002C9.47631 13.7755 9.6132 13.4692 9.62502 13.1456L9.87502 5.57938C9.88049 5.41362 9.95158 5.25682 10.0727 5.14348C10.1937 5.03014 10.3549 4.96953 10.5206 4.975C10.6864 4.98047 10.8432 5.05157 10.9565 5.17265C11.0699 5.29373 11.1305 5.45487 11.125 5.62063ZM11.9519 3.1025C11.9519 3.26826 11.886 3.42724 11.7688 3.54445C11.6516 3.66166 11.4927 3.7275 11.3269 3.7275H0.673767C0.508007 3.7275 0.349035 3.66166 0.231825 3.54445C0.114615 3.42724 0.0487671 3.26826 0.0487671 3.1025C0.0487671 2.93674 0.114615 2.77777 0.231825 2.66056C0.349035 2.54335 0.508007 2.4775 0.673767 2.4775H2.61127C2.8093 2.47804 3.00044 2.40487 3.1475 2.27225C3.29457 2.13963 3.38703 1.95704 3.40689 1.76C3.45301 1.29781 3.66956 0.869336 4.01433 0.558072C4.3591 0.246807 4.8074 0.0750461 5.27189 0.0762545H6.72814C7.19263 0.0750461 7.64094 0.246807 7.98571 0.558072C8.33048 0.869336 8.54702 1.29781 8.59314 1.76C8.61301 1.95704 8.70547 2.13963 8.85253 2.27225C8.99959 2.40487 9.19074 2.47804 9.38877 2.4775H11.3263C11.492 2.4775 11.651 2.54335 11.7682 2.66056C11.8854 2.77777 11.9513 2.93674 11.9513 3.1025H11.9519ZM4.49189 2.4775H7.50939C7.42726 2.28984 7.37355 2.09099 7.35002 1.8875C7.33453 1.73345 7.26242 1.59062 7.14764 1.4867C7.03286 1.38278 6.8836 1.32516 6.72877 1.325H5.27252C5.11768 1.32516 4.96842 1.38278 4.85364 1.4867C4.73887 1.59062 4.66675 1.73345 4.65127 1.8875C4.62754 2.09103 4.57424 2.28988 4.49189 2.4775ZM5.12127 11.9469V6.625C5.12127 6.45924 5.05542 6.30027 4.93821 6.18306C4.821 6.06585 4.66203 6 4.49627 6C4.33051 6 4.17154 6.06585 4.05433 6.18306C3.93711 6.30027 3.87127 6.45924 3.87127 6.625V11.9494C3.87127 12.1151 3.93711 12.2741 4.05433 12.3913C4.17154 12.5085 4.33051 12.5744 4.49627 12.5744C4.66203 12.5744 4.821 12.5085 4.93821 12.3913C5.05542 12.2741 5.12127 12.1151 5.12127 11.9494V11.9469ZM8.13002 11.9469V6.625C8.13002 6.45924 8.06417 6.30027 7.94696 6.18306C7.82975 6.06585 7.67078 6 7.50502 6C7.33926 6 7.18029 6.06585 7.06308 6.18306C6.94586 6.30027 6.88002 6.45924 6.88002 6.625V11.9494C6.88002 12.1151 6.94586 12.2741 7.06308 12.3913C7.18029 12.5085 7.33926 12.5744 7.50502 12.5744C7.67078 12.5744 7.82975 12.5085 7.94696 12.3913C8.06417 12.2741 8.13002 12.1151 8.13002 11.9494V11.9469Z"
                  fill="#E11D48"
                />
              </svg>
              <p className="ml-2 text-secondary-600 text-sm font-normal">
                Удалить
              </p>
            </div>
            <div className="w-full h-px bg-white-2 mt-1 mb-1"></div>
            <div className="px-4 text-sm font-normal text-secondary-400">
              <div>Заметка: {name}</div>
            </div>
            <div className="px-4 py-1 text-xs font-normal text-secondary-400 opacity-80">
              Дата создания: <span>{createNote.slice(0, 10)}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};
